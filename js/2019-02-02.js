let drawing,dark,lastPoints,rOpt,gOpt,bOpt,aOpt,guides=[],viewGuides=!1;const colorFunctions=[e=>240*abs(sin(e)),e=>240*abs(cos(e)),e=>240*abs(tan(e)),e=>240*abs(sin(e+PI)),e=>240*abs(cos(e+PI)),e=>240*abs(tan(e+PI)),e=>240*abs(sin(-e)),e=>240*abs(cos(-e)),e=>240*abs(tan(-e)),e=>240*abs(sin(-e+PI)),e=>240*abs(cos(-e+PI)),e=>240*abs(tan(-e+PI))];function setFill(e){drawing.fill(rOpt(e),gOpt(e),bOpt(e),aOpt(3*e))}function setup(){for(pixelDensity(4),createCanvas(660,840).parent("my-canvas"),dark=random([0,1]),(drawing=createGraphics(width,height)).background(dark?0:255),drawing.stroke(dark?255:0),drawing.strokeWeight(100),drawing.line(.25*width,150,.25*width,height-150),drawing.line(.5*width,150,.5*width,height-150),drawing.line(.75*width,150,.75*width,height-150),drawing.blendMode(dark?DARKEST:LIGHTEST),drawing.noStroke();[...new Set([rOpt,gOpt,bOpt,aOpt])].length<4;)rOpt=random(colorFunctions),gOpt=random(colorFunctions),bOpt=random(colorFunctions),aOpt=random(colorFunctions);for(let e=0;e<4;e++)guides.push({r:HALF_PI*e,speed:random(.01,.1*(2-e/2))/TWO_PI,direction:random([-1,1])});guides.sort((e,i)=>e.r-i.r)}function draw(){background(255),image(drawing,0,0);const e=polarToCartesianX(width/2,guides[0].r,width/2),i=width,t=height/2+sin(guides[1].r)*(height/2),n=polarToCartesianX(width/2,guides[2].r,width/2),a=height,r=height/2+sin(guides[3].r)*(height/2),s=lerp(0,e,.2),d=lerp(r,0,.2),o=lerp(i,n,.2),l=lerp(t,a,.2);viewGuides&&(stroke("red"),strokeWeight(1),line(i,t,n,a),line(0,r,e,0),strokeWeight(6),line(i,t,0,r),line(i,t,o,l),line(0,r,s,d),ellipse(o,l,12),ellipse(s,d,12));for(let e=0;e<guides.length;e++)guides[e].r+=guides[e].speed*guides[e].direction;frameCount>1&&(setFill(guides[0].r),drawing.beginShape(),drawing.vertex(i,t),drawing.bezierVertex(o,l,s,d,0,r),drawing.vertex(lastPoints.X3,lastPoints.Y3),drawing.bezierVertex(lastPoints.leftHandleX,lastPoints.leftHandleY,lastPoints.rightHandleX,lastPoints.rightHandleY,lastPoints.X1,lastPoints.Y1),drawing.endShape()),lastPoints={X0:e,Y0:0,X1:i,Y1:t,X2:n,Y2:a,X3:0,Y3:r,rightHandleX:o,rightHandleY:l,leftHandleX:s,leftHandleY:d},abs(guides[1].r)>3*TWO_PI&&abs(guides[3].r)>3*TWO_PI&&(noLoop(),drawingComplete=!0)}function mousePressed(){viewGuides=!viewGuides,drawingComplete&&redraw()}